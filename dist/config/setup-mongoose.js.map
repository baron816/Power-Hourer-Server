{"version":3,"sources":["../../src/config/setup-mongoose.js"],"names":["cleanup","reset","connection","db","dropDatabase","close","process","env","set","MONGODB_URI","connect","setupMongoose","Promise","uri","catch","error","console","reject"],"mappings":";;;;;;;uDAIA;AAAA,QAWWA,OAXX,EAeWC,KAfX;AAAA;AAAA;AAAA;AAAA;AAeWA,iBAfX,YAeWA,KAfX,GAemB;AACf,iCAASC,UAAT,CAAoBC,EAApB,CAAuBC,YAAvB;AACD,aAjBH;;AAWWJ,mBAXX,YAWWA,OAXX,GAWqB;AACjB,iCAASE,UAAT,CAAoBG,KAApB;AACD,aAbH;;AACE,gBAAI,mBAAmBC,QAAQC,GAA/B,EAAoC;AAClC,iCAASC,GAAT,CAAa,OAAb,EAAsB,IAAtB;AACD;;AAHH,iBAKMF,QAAQC,GAAR,CAAYE,WALlB;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAMUC,QAAQJ,QAAQC,GAAR,CAAYE,WAApB,CANV;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,mBAQUC,QAAQ,uCAAR,CARV;;AAAA;AAAA,6CAmBS;AACLV,8BADK;AAELC;AAFK,aAnBT;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G;;kBAAeU,a;;;;;AAJf;;;;;;;;AAEA,mBAASC,OAAT,GAAmBA,OAAnB;;AA2BA,SAASF,OAAT,CAAiBG,GAAjB,EAAsB;AACpB,SAAO,mBAASH,OAAT,CAAiBG,GAAjB,EAAsBC,KAAtB,CAA4B,UAAUC,KAAV,EAAiB;AAClDC,YAAQD,KAAR,CACE,oDADF,EAEE,8BAFF;AAIA,WAAOH,QAAQK,MAAR,CAAeF,KAAf,CAAP;AACD,GANM,CAAP;AAOD;;kBAEcJ,a","file":"setup-mongoose.js","sourcesContent":["import mongoose from 'mongoose';\n\nmongoose.Promise = Promise\n\nasync function setupMongoose() {\n  if ('MONGODB_DEBUG' in process.env) {\n    mongoose.set('debug', true)\n  }\n\n  if (process.env.MONGODB_URI) {\n    await connect(process.env.MONGODB_URI)\n  } else {\n    await connect('mongodb://localhost/power-hourer-test')\n  }\n\n  function cleanup() {\n    mongoose.connection.close()\n  }\n\n  function reset() {\n    mongoose.connection.db.dropDatabase()\n  }\n\n  return {\n    cleanup,\n    reset\n  }\n}\n\nfunction connect(uri) {\n  return mongoose.connect(uri).catch(function (error) {\n    console.error(\n      'There was a problem connecting mongoose to mongodb',\n      'Do you have mongodb running?'\n    );\n    return Promise.reject(error);\n  })\n}\n\nexport default setupMongoose\n"]}