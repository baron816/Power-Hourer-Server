{"version":3,"sources":["../../src/auth/auth.js"],"names":["signToken","decodeToken","authorizeUser","checkToken","secret","id","sign","_id","expiresIn","expireTime","req","res","next","query","hasOwnProperty","headers","authorization","id_token","user","String","playlist","owner","sendStatus"],"mappings":";;;;;QAMgBA,S,GAAAA,S;QAQAC,W,GAAAA,W;QAUAC,a,GAAAA,a;;AAxBhB;;;;AACA;;;;AACA;;;;;;AAEA,IAAMC,aAAa,0BAAW,EAAEC,QAAQ,iBAAOA,MAAjB,EAAX,CAAnB;;AAEO,SAASJ,SAAT,CAAmBK,EAAnB,EAAuB;AAC5B,SAAO,uBAAIC,IAAJ,CACL,EAACC,KAAKF,EAAN,EADK,EAEL,iBAAOD,MAFF,EAGL,EAACI,WAAW,iBAAOC,UAAnB,EAHK,CAAP;AAKD;;AAEM,SAASR,WAAT,GAAuB;AAC5B,SAAO,UAAUS,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AAC/B,QAAIF,IAAIG,KAAJ,IAAaH,IAAIG,KAAJ,CAAUC,cAAV,CAAyB,UAAzB,CAAjB,EAAuD;AACrDJ,UAAIK,OAAJ,CAAYC,aAAZ,GAA4B,YAAYN,IAAIG,KAAJ,CAAUI,QAAlD;AACD;;AAEDd,eAAWO,GAAX,EAAgBC,GAAhB,EAAqBC,IAArB;AACD,GAND;AAOD;;AAEM,SAASV,aAAT,GAAyB;AAC9B,SAAO,UAAUQ,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AAC/B,QAAIF,IAAIQ,IAAJ,CAASX,GAAT,KAAiBY,OAAOT,IAAIU,QAAJ,CAAaC,KAApB,CAArB,EAAiD;AAC/CV,UAAIW,UAAJ,CAAe,GAAf;AACD,KAFD,MAEO;AACLV;AACD;AACF,GAND;AAOD","file":"auth.js","sourcesContent":["import jwt from 'jsonwebtoken';\nimport expressJwt from 'express-jwt';\nimport config from '../config/config';\n\nconst checkToken = expressJwt({ secret: config.secret});\n\nexport function signToken(id) {\n  return jwt.sign(\n    {_id: id},\n    config.secret,\n    {expiresIn: config.expireTime}\n  );\n}\n\nexport function decodeToken() {\n  return function (req, res, next) {\n    if (req.query && req.query.hasOwnProperty('id_token')) {\n      req.headers.authorization = 'Bearer ' + req.query.id_token;\n    }\n\n    checkToken(req, res, next);\n  };\n}\n\nexport function authorizeUser() {\n  return function (req, res, next) {\n    if (req.user._id !== String(req.playlist.owner)) {\n      res.sendStatus(401);\n    } else {\n      next();\n    }\n  };\n}\n"]}